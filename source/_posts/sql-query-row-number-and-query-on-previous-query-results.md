title: "Заметка: Получение порядкового номера строки в результатах SQL запроса"
type: "simple"
date: 2013-03-14 11:45
description: "Получение порядкового номера строки в результатах SQL запроса и запрос на результатах предидущего запроса"
tags:
- sql
---

Знакомый обратился с примерно таким вопросом: есть таблица с пользователями, типом рейтинга и самим рейтингом - нужно получить позицию пользователя в этом самом рейтинги с типом, например, равным 1.

В итоге получился вот такой запрос:

```
    SELECT row_number FROM (
        SELECT *,
        @curRow := @curRow + 1 AS row_number
        FROM    user_raiting
        JOIN(SELECT @curRow := 0) r
        WHERE   type = 1
        ORDER BY raiting DESC
    ) AS c
    WHERE user_id = 4
```

Смысл очень просто, в запросе в том, что внутри () получаем все записи с нужным типом рейтинга и нумеруем их **@curRow**. Затем по результатам предидущего запроса делаем наш финальный запрос, который получает номер строки соответствующей нужному нам пользователю.

Записал для себя, как делать запрос по результатам другого запроса, ну и как номеровать строки в результате запроса.
